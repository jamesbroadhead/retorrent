--- renpy-6.13.7-unpatched/module/IMG_savepng.c	2009-04-02 02:44:53.000000000 +0100
+++ renpy-6.13.7/module/IMG_savepng.c	2011-10-21 15:28:20.991437000 +0100
@@ -28,8 +28,14 @@
 #include <SDL/SDL.h>
 #include <SDL/SDL_byteorder.h>
 #include <png.h>
+#include <zlib.h>
 #include "IMG_savepng.h"
 
+// Backwards compat. with libpng-1.2 - libpng-1.4
+#ifndef png_voidp
+	#define png_voidp voidp
+#endif
+		
 int IMG_SavePNG(const char *file, SDL_Surface *surf,int compression){
 	SDL_RWops *fp;
 	int ret;
@@ -84,7 +90,7 @@
 		goto savedone;
 	}
 	/* setup custom writer functions */
-	png_set_write_fn(png_ptr,(voidp)src,png_write_data,NULL);
+	png_set_write_fn(png_ptr,(png_voidp)src,png_write_data,NULL);
 
 	if (setjmp(png_jmpbuf(png_ptr))){
 		SDL_SetError("Unknown error writing PNG");
