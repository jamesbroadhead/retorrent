#!/usr/bin/python

import os
from os.path import abspath
import sys

from retorrentlib import confparse

def main():
    paths = set()
    _, categories_conf = confparse.parse_retorrentconf()
    for catname, catdict in categories_conf.items():
        for path in catdict['content_paths']:
            if not path.endswith(catname):

                print 'error! bad path for %s: %s' % (catname, path)
                sys.exit(1)

            paths.add(abspath(path[:-(len(catname))]))

    for path in paths:
        print path
        os.listdir(path) # if this succeeds, all is well

    # TODO: test with offline drive
    # http://stackoverflow.com/questions/12217027/how-to-make-a-function-return-after-5-seconds-passed-in-python

if __name__ == '__main__':
    main()
